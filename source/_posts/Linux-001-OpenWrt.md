---
title: Netgear WNDR3700V4åˆ·OpenWrtï¼Œå¯¹æ ¡å›­ç½‘IPv6ä½¿ç”¨çš„è¿›ä¸€æ­¥æ¢ç´¢
date: 2019-05-02 19:34:36
tags: 
    - IPv6
    - Shadowsocks
    - Linux
    - OpenWrt
    - è·¯ç”±å™¨
    - Netgear
    - æ ¡å›­ç½‘
---
2018-08-12  
ç”¨é—²é±¼ä¸Šæ·˜çš„Netgearè·¯ç”±å™¨åˆ·Openwrtç³»ç»Ÿï¼Œè®¾ç½®IPv6ï¼Œå°è¯•shadowsocksï¼Œå®ç°æ ¡å›­ç½‘åŠ é€Ÿ/ä¸å®Œç¾å…è´¹å…æµï¼Œè·¯ç”±å™¨çš„ssæ„Ÿè§‰å¹¶ä¸èƒ½è¾¾åˆ°è¦æ±‚ã€‚ã€‚
ssä»£ç†

* æ”¯æŒWindows 10/Linux
* æ”¯æŒå®‰å“(æµ‹è¯•Android 8ï¼Œä¸‰ä¸§OEM)
* iOSéœ€è¦è´­ä¹°ä»£ç†è½¯ä»¶
IPv6ä»…å¯¹äºpcç«¯ä½¿ç”¨æœ‰æ•ˆï¼Œå®‰å“èƒ½è·å–IPv6åœ°å€ä½†ä¸çŸ¥é“ä¸ºå•¥è¿ä¸ä¸Šv6çš„ä»£ç†ï¼Ÿï¼Ÿ

<!-- more -->


## è®¾å¤‡ä»‹ç»

ç½‘ä»¶WNDR3700V4è·¯ç”±å™¨ï¼Œå¤§æ¦‚æ˜¯14å¹´å‡ºçš„ï¼Œä»·ä½å¤§æ¦‚300+å·¦å³ï¼Œé…ç½®è¿˜æ˜¯å¾ˆè±ªåçš„ï¼Œæ¯•ç«Ÿæ˜¯ä¸“ä¸šçš„å‚å®¶ï¼Œå’ŒæŸäº›è´´ç‰Œçš„ä¸ä¸€æ ·ã€‚

### ç¡¬ä»¶é…ç½®
    > latform:  Atheros AR9344
    > Target:   ar71xx
    > Instruction Set:  MIPS32
    > Sub Instruction Set:  MIPS32 74K series
    > Bootloader:   U-Boot
    > CPU MHz:  560
    > Flash MB: 128NAND
    > RAM MB:   128
    > Ethernet 100M ports:  -
    > Ethernet GBit ports:  5
    > Modem:    No
    > Comments network ports:   1 WAN + 4x LAN
    > VLAN: Yes
    > WLAN Hardware:    AR9582 [an 2x2:2] + AR9344 [bgn 2x2:2]
    > WLAN 2.4GHz:  b/g/n
    > WLAN 5.0GHz:  a/n
    > WLAN Comments:    2x2:2 MIMO
    > Detachable Antennas:  -
    > USB ports:    1x 2.0
    > SATA ports:   -
    > Serial:   Yes
    > JTAG: Yes

æ•°æ®æ¥è‡ª[OpenWrtçš„Wiki](https://wiki.openwrt.org/toh/hwdata/netgear/netgear_wndr3700_v4)ï¼Œåˆ·æœºå›ºä»¶ç­‰ä¹Ÿæ¥è‡ªäºæ­¤ã€‚
[WNDR3700å„ä¸ªç‰ˆæœ¬çš„å¯¹æ¯”](https://wiki.openwrt.org/toh/netgear/wndr3700#tab__hardware_details)
> ![å¯¹æ¯”å›¾å±€éƒ¨](Linux-001-OpenWrt/hardware.png)

### å¼€ç®±
åœ¨é—²é±¼ä¸ŠèŠ±äº†100å—é’±æ·˜åˆ°çš„ï¼š
> ![å¼€ç®±1](Linux-001-OpenWrt/open1.jpg)
> ![å¼€ç®±2](Linux-001-OpenWrt/open2.jpg)
> ![å¼€ç®±3](Linux-001-OpenWrt/open3.jpg)
> ![å¼€ç®±4](Linux-001-OpenWrt/open4.jpg)


## åˆ·æœº
### å‡†å¤‡å·¥ä½œ
* OpenWrtçš„å®˜æ–¹å›ºä»¶(å…¶å®æ˜¯å› ä¸ºæˆ‘ä¸ä¼šè‡ªå·±ç¼–è¯‘emmmm)
* è·¯ç”±å™¨
* ç”µè„‘(Windows 10)
* ç½‘çº¿
* SSHå·¥å…·(æˆ‘é€‰æ‹©putty)
* SCPä¼ è¾“å·¥å…·(æˆ‘é€‰æ‹©WinSCP)
* ç‰™ç­¾(é¿å…å˜ç –åº”æ€¥ç”¨çš„)
* tftpå·¥å…·å’ŒNetgearçš„å®˜æ–¹å›ºä»¶(åŒä¸Šï¼Œæ•‘ç –)

å›ºä»¶ç‰ˆæœ¬ï¼šOpenwrt Chaos Calmer 15.05.1ï¼Œä½¿ç”¨å®˜æ–¹æä¾›çš„å›ºä»¶ã€‚
å›ºä»¶å¯ä»¥ä»[OpenWrtçš„Wiki](https://wiki.openwrt.org/toh/hwdata/netgear/netgear_wndr3700_v4)ä¸­è·å¾—ã€‚

### å…ˆå‰çš„å°è¯•
* å› ä¸ºå‰ä¸€æ®µæ—¶é—´åˆ·è¿‡ä¸€ä¸ªå°çš„è·¯ç”±å™¨ï¼ŒTP-Linkçš„WR720N V4ï¼Œä½†æ˜¯ROMå¤ªå°äº†æ²¡æœ‰åŠ ä»€ä¹ˆæ’ä»¶ä¹‹ç±»çš„ã€‚
* é‚£ä¸ªè·¯ç”±å™¨å…ˆåˆ·çš„è§£é”Bootloaderçš„OpenWrtå›ºä»¶ï¼Œ
![barrierbreaker](Linux-001-OpenWrt/barrier.png)
* ç„¶ååˆ·äº†Breedçš„Bootloaderï¼Œæœ€ååœ¨ç”¨Breedå‡çº§çš„æ­£å¸¸çš„OpenWrtã€‚
![chaoscalmer](Linux-001-OpenWrt/calmer.png)
* æœŸé—´ï¼Œå˜ç –ä¸€æ¬¡ï¼ŒæŠ¢æ•‘ä¸€ä¸‹åˆï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ²¡æ•‘äº†ï¼Œç›´åˆ°ä¸€æ¬¡å¶ç„¶å¯åŠ¨å‘ç°ç¯äº®äº†ï¼Œäºæ˜¯æŠ¢æ•‘ä¸€ä¸‹ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯æ€ä¹ˆæå¾—å°±ä¸åœçš„ä¼ æœ€åå°±æ•‘å›æ¥çš„ã€‚
æ€»çš„æ¥è¯´å°±æ˜¯å®‰å…¨æ¨¡å¼æ„Ÿå¤©åŠ¨åœ°ã€‚= =
* æ•‘ç –çš„æ—¶å€™ä¸å°å¿ƒè¿˜ç”¨ __*ï¼Ÿï¼Ÿï¼Ÿç *__ è¿›å…¥äº†æ¥¼é‡Œçš„ä¸€ä¸ªåä¸ºè·¯ç”±å™¨(/äº¤æ¢æœºï¼Ÿï¼Ÿ)ï¼Œå¹³æ—¶æ£€æµ‹ä¸åˆ°å¤§æ¦‚æ˜¯å› ä¸ºipåœ°å€ä¸è·¯ç”±å™¨çš„å±€åŸŸç½‘åœ°å€å†²çªäº†ï¼Œä¹Ÿè®¸è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå­¦æ ¡é€šå‘Šé‡Œå†™çš„è¦å…³é—­è·¯ç”±å™¨çš„DHCPæœåŠ¡(è™½ç„¶ä¸å…³ä¹Ÿèƒ½ç”¨è¯¶)ã€‚
![huawei](Linux-001-OpenWrt/huawei.jpg)

å‡†å¤‡å¥½å›ºä»¶å’Œè·¯ç”±å™¨è¿˜æœ‰æ•‘ç –çš„å‡†å¤‡å°±å¯ä»¥å¼€å§‹äº†ã€‚

å› ä¸ºç°åœ¨ç³»ç»Ÿå°±æ˜¯åŸç‰ˆçš„ï¼Œå¯ä»¥ç›´æ¥ç”¨åå°ä¸Šä¼ å›ºä»¶ã€‚
### ç‰©ç†è¿æ¥
ç¬¬ä¸€æ­¥æ˜¯ç‰©ç†è¿æ¥ï¼Œè·¯ç”±å™¨æ˜¯åŸç‰ˆçš„ç³»ç»Ÿï¼Œå› ä¸ºä¸ºäº†é¿å…åœ¨åˆ·æœºè¿‡ç¨‹ä¸­æ²¡æœ‰ç½‘ï¼Œäºæ˜¯æˆ‘æŠŠæ­£åœ¨ç”¨çš„å¦ä¸€ä¸ªè·¯ç”±å™¨çš„åœ°å€æ”¹æˆäº†`10.0.0.1`

ä½¿ç”¨æ—¶æˆ‘å…ˆè¯•çš„å°†Internetå£ï¼Œä¹Ÿå°±æ˜¯WANå£ä¸ç¬”è®°æœ¬çš„ç½‘å£è¿›è¡Œè¿æ¥ï¼Œç„¶åä½¿ç”¨cmdè¿›è¡Œ`ping`è¿æ¥æµ‹è¯•ï¼Œ

ç™»å½•`192.168.1.1`ï¼Œè¾“å…¥é»˜è®¤ç”¨æˆ·åå’Œå¯†ç ï¼Œè¿›å…¥åå°ã€‚

ä¸Šä¼ å›ºä»¶ã€‚
é‡æ–°å¯åŠ¨ã€‚

### è¿›å…¥åå°
* å¯åŠ¨åä¾ç„¶è¾“å…¥`192.168.1.1`è¿›å…¥ç®¡ç†ç•Œé¢ï¼Œè¿™æ˜¯ä¼šè‡ªåŠ¨è·³è½¬è‡³Openwrtçš„Webç•Œé¢(Luci)ã€‚
ç”¨æˆ·åï¼š`root`
å¯†ç ï¼šéšæ„è®¾ç½®
* ç„¶åé¡µé¢ä¸Šæ–¹ä¼šæœ‰ä¸€æ®µæç¤ºæœªè®¾ç½®å¯†ç çš„è‹±æ–‡ï¼Œç‚¹è¿›å»è®¾ç½®ä¸€ä¸‹å°±è¡Œï¼Œ__è¿™æ­¥å¿…é¡»åš__ å¦åˆ™SSHå¯èƒ½æ— æ³•ç™»å½•ã€‚

* è®¾ç½®å®Œå¯†ç åï¼ŒLuciç•Œé¢çš„æ¦‚å†µå¦‚ä¸‹ï¼š
![home](Linux-001-OpenWrt/index.png)
* ä½¿ç”¨puttyç™»å…¥è·¯ç”±å™¨åå°ï¼Œå°±ä¼šæ˜¾ç¤ºä»¥ä¸‹ç•Œé¢ï¼š
![login in](Linux-001-OpenWrt/login.png)
* é¦–å…ˆè¦æ›´æ–°é…ç½®æºï¼Œä¹Ÿå°±æ˜¯å®‰è£…åŒ…çš„æ¥æºï¼š
`opkg update`
* ç„¶åå¯(yi)èƒ½(ding)ä¼šå‡ºç°ç±»ä¼¼ä»¥ä¸‹çš„æŠ¥é”™ï¼š
```
opkg_conf_load: Could not lock /var/lock/opkg.lock: Resource temporarily unavailable.
```

* è¿™æ—¶å°±è¦ä¾æ¬¡è¾“å…¥ä»¥ä¸‹å¹¶é‡æ–°æ›´æ–°æºï¼š
```
echo "nameserver 114.114.114.114">/tmp/resolv.conf
rm -f /var/lock/opkg.lock
opkg update
```
ä»¥ä¸Šå¯ä»¥çœ‹ä¸ºæ·»åŠ å›½å†…åŸŸåè§£æåˆ°ä¸´æ—¶åˆ†åŒºï¼Œå¹¶ä¸”å¯¹å®‰è£…æºçš„é”è§£é”/åˆ é™¤ï¼Œç„¶åæ›´æ–°çš„å‘½ä»¤

* ç­‰æºæ›´æ–°å®Œåï¼Œå†æ¬¡å‡ºç°rootå‘½ä»¤è¾“å…¥æ—¶ï¼Œè¾“å…¥ï¼š
`opkg install wget`
å®‰è£…GNU wgetæ¨¡å—ï¼Œä¸ºåé¢åšå‡†å¤‡ã€‚

ç„¶åå¯ä»¥é€‰æ‹©ä»webç•Œé¢ä¸­æ·»åŠ è½¯ä»¶åŒ…ä¹Ÿå¯ä»¥é€‰æ‹©ä»å‘½ä»¤è¡Œ(CLI)æ·»åŠ ã€‚
* å¦‚æœè‹±æ–‡ç•Œé¢çœ‹ç€ä¸çˆ½ï¼Œå¯ä»¥å®‰è£…`luci-i18n-base-zh-cn`ç®€ä¸­çš„ç•Œé¢è¯­è¨€åŒ…ï¼Œå®‰è£…å®Œæˆåï¼Œåˆ°`ç³»ç»Ÿ-ç³»ç»Ÿ-è¯­è¨€ä¸ç•Œé¢`ä¸­æ›´æ¢ä¸­æ–‡ç•Œé¢ã€‚
åœ¨åŒä¸€çº§ç•Œé¢ä¸­å¯ä»¥å°†è·¯ç”±å™¨æ—¶é—´æ”¹åˆ°`Asia/Shanghai`ã€‚

### å¼€å¯wifi
å¯ä»¥é€‰æ‹©ç°åœ¨å¼€å¯wifiï¼Œä¹Ÿå¯ä»¥æœ€åé…ç½®å®Œå†å¼€å¯ï¼Œå› ä¸ºwifiç›´æ¥æ¡¥æ¥çš„`lan`å£ï¼Œæ‰€ä»¥åº”è¯¥æ—¶æ— æ‰€è°“çš„ã€‚
ç›´æ¥åœ¨`ç½‘ç»œ-æ— çº¿`ç•Œé¢ä¸­é…ç½®å³å¯ï¼Œ802.11anåè®®çš„æ˜¯5Gä¿¡å·çš„wifiï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯2.4Gçš„ã€‚
æ·»åŠ å‰å¯ä»¥ä½¿ç”¨æ‰«ææ¥æŸ¥çœ‹ç°æœ‰ç¯å¢ƒä¸­çš„æ‰€æœ‰å¹¿æ’­çš„Wifiä¿¡å·ä»¥åŠå®ƒä»¬çš„ä¿¡æ¯å¦‚ä¿¡é“ç­‰ã€‚
è®¾ç½®çš„æ—¶å€™é€‰æ‹©ä¸€ä¸ªä½¿ç”¨äººæ•°æœ€å°‘çš„ä¿¡é“ï¼ŒåŠŸç‡å¯ä»¥è°ƒåˆ°æœ€å¤§ï¼Œä¸€å®šä¸è¦`éšè—ESSID`ï¼ŒSSIDç›¸å½“ä¸Wifiçš„åå­—ï¼Œé»˜è®¤éƒ½æ˜¯å¹¿æ’­çš„ï¼Œéšè—äº†å°±åªèƒ½æ‰‹åŠ¨è¾“å…¥æ·»åŠ è¿æ¥äº†ã€‚
å®‰å…¨è®¾ç½®ä¸­åŠ å¯†æ–¹å¼é€‰æ‹©`WPA2-PSK`ï¼Œç®—æ³•è‡ªåŠ¨ï¼Œæ·»åŠ å¯†ç ã€‚

## è®¾ç½®ç½‘ç»œå¹¶å¼€å¯IPv6
### ä»€ä¹ˆæ˜¯IPv6
* IPv6æ˜¯Internet Protocol Version 6çš„ç¼©å†™ã€‚IPv6æ˜¯IETFï¼ˆäº’è”ç½‘å·¥ç¨‹ä»»åŠ¡ç»„ï¼ŒInternet Engineering Task Forceï¼‰è®¾è®¡çš„ç”¨äºæ›¿ä»£ç°è¡Œç‰ˆæœ¬IPåè®®ï¼ˆIPv4ï¼‰çš„ä¸‹ä¸€ä»£IPåè®®ã€‚IPv6çš„å…è®¸çš„åºå¤§åœ°å€æ•°é‡ä¹Ÿä½¿å¾—å…¶æˆä¸ºç‰©è”ç½‘æ—¶ä»£çš„å…³é”®ï¼Œæœ€è¿‘æˆ‘å›½ä¹Ÿå‡ºå°äº†ç›¸åº”çš„IPv6å‘å±•è®¡åˆ’ï¼Œå°†å¤§åŠ›æ¨åŠ¨IPv4å‘v6è¿‡æ¸¡ã€‚
* IPv6å¯¹äºæ™®é€šç”¨æˆ·æ¥è¯´å’ŒIPv4æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯åœ°å€è¡¨ç¤ºä¸åŒï¼ŒIPv6ç½‘é€Ÿå¿«å…¶ä¸€æ˜¯ç”¨çš„äººå°‘ï¼ŒåŠ ä¸Šæœ¬èº«çš„ç½‘ç»œå±‚æ¬¡æ‰å¹³ï¼Œä½¿å¾—é“¾è·¯æ‹¥å¡è¾ƒå°‘(å› ä¸ºIPv6çš„è®¾å®šæ˜¯å…¨çƒæ¯å°è®¾å¤‡éƒ½æœ‰å”¯ä¸€çš„åœ°å€ï¼Œå› æ­¤ __*å°±åƒ*__ ä¸€ä¸ªå±€åŸŸç½‘ä¸€æ ·);å…¶äºŒæ˜¯åŸºç¡€è®¾å¤‡å»ºè®¾æ›´ä¼˜ç§€ï¼Œå¸¦å®½æ›´å¤§ï¼Œå› æ­¤ç½‘é€Ÿä¹Ÿå°±ä¼šå¿«ä¸€äº›ï¼Œæ®è¯´å°†ç°æœ‰çš„IPv4ç”¨æˆ·å…¨éƒ¨è½¬ç§»è‡³IPv6ç½‘ç»œï¼Œç½‘é€Ÿä¾ç„¶å¯ä»¥æé«˜10å€ã€‚

### IPv6çš„ç‰¹ç‚¹
IPv6æœ‰è¯¸å¤šä¸åŒï¼Œä¹Ÿä½¿å¾—å…¶é…ç½®æ–¹å¼å’ŒIPv4ä¸ä¸€æ ·ã€‚
* å…·æœ‰æ›´å¤§çš„åœ°å€ç©ºé—´ï¼š128ä½
* ä½¿ç”¨æ›´å°çš„è·¯ç”±è¡¨
* å¢å¼ºçš„ç»„æ’­æ”¯æŒä»¥åŠå¯¹æµçš„æ§åˆ¶
* æ— çŠ¶æ€è‡ªåŠ¨é…ç½®
* å¼ºåˆ¶ä½¿ç”¨IPSecåŠ å¯†é€šè®¯ï¼Œæ›´å®‰å…¨
* Â·Â·Â·æ›´å¤šå…·ä½“å†…å®¹å‚è§ç»´åŸºç™¾ç§‘ä¸è®¡ç®—æœºç½‘ç»œä¹¦ç±

* *å¦‚æœæ˜¯windowsç³»ç»Ÿï¼Œä¸ºäº†ä¿æŠ¤macåœ°å€ä¼šé¢å¤–ç”Ÿæˆä¸€ä¸ªä¸´æ—¶IPv6åœ°å€ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªä¸´æ—¶åœ°å€é€šä¿¡ï¼Œç¦ç”¨è¿™ä¸ªä¸´æ—¶åœ°å€ä½¿ç”¨å‘½ä»¤ï¼šnetsh interface IPv6 set privacy state=disable*

### ä»IPv4åˆ°IPv6
#### è¿‡æ¸¡
1. éš§é“
    éš§é“ï¼ˆTunnelingï¼‰æ˜¯å¦ä¸€ä¸ªç”¨æ¥é“¾æ¥IPv4ä¸IPv6çš„æœºåˆ¶ã€‚ä¸ºäº†è¿é€šIPv6äº’è”ç½‘ï¼Œä¸€ä¸ªå­¤ç«‹ä¸»æœºæˆ–ç½‘ç»œéœ€è¦ä½¿ç”¨ç°å­˜IPv4çš„åŸºç¡€è®¾æ–½æ¥æºå¸¦IPv6æ•°æ®åŒ…ã€‚è¿™å¯ç”±å°†IPv6æ•°æ®åŒ…è£…å…¥IPv4æ•°æ®åŒ…çš„éš§é“åè®®æ¥å®Œæˆï¼Œå®é™…ä¸Šå°±æ˜¯å°†IPv4å½“æˆIPv6çš„é“¾æ¥å±‚ã€‚
    IPåè®®å·ç çš„41å·ç”¨æ¥æ ‡ç¤ºå°†IPv6æ•°æ®è®¯æ¡†ç›´æ¥è£…å…¥IPv4æ•°æ®åŒ…ã€‚IPv6äº¦èƒ½åŠ å…¥UDPæ•°æ®åŒ…ï¼Œå¦‚ä¸ºäº†è·¨è¿‡ä¸€äº›ä¼šé˜»æŒ¡åè®®41æµé‡çš„è·¯ç”±å™¨æˆ–NATè®¾å¤‡ã€‚å…¶å®ƒæµè¡Œçš„å°è£…æœºåˆ¶åˆ™æœ‰AYIYAå’ŒGREã€‚ 
    
2. åŒå †æ ˆ
    åŒå †æ ˆï¼ˆDual IP stack implementationï¼‰æ˜¯å°†IPv6è§†ä¸ºä¸€ç§IPv4çš„å»¶ä¼¸ï¼Œä»¥å…±äº«ä»£ç çš„æ–¹å¼å»å®ç°ç½‘ç»œå †æ ˆï¼Œå…¶å¯ä»¥åŒæ—¶æ”¯æŒIPv4å’ŒIPv6ï¼Œå¦‚æ­¤æ˜¯ç›¸å¯¹è¾ƒä¸ºå®¹æ˜“çš„ã€‚å¦‚æ­¤çš„å®ç°ç§°ä¸ºâ€œåŒå †æ ˆâ€ï¼Œå¹¶ä¸”ï¼Œä¸€ä¸ªå®ç°åŒå †æ ˆçš„ä¸»æœºç§°ä¸ºâ€œåŒå †æ ˆä¸»æœºâ€ã€‚è¿™æ­¥éª¤æè¿°äºRFC 4213ã€‚
    ç›®å‰å¤§éƒ¨åˆ†IPv6çš„å®ç°ä½¿ç”¨åŒå †æ ˆã€‚ä¸€äº›æ—©æœŸå®éªŒæ€§å®ç°ä½¿ç”¨ç‹¬ç«‹çš„IPv4å’ŒIPv6å †æ ˆã€‚ 
#### IPv6çš„é“¾è·¯æ–¹å¼
ä¸€æ–¹é¢å¯ä»¥çœ‹æˆè¿‡æ¸¡ï¼Œå¦ä¸€æ–¹å¯ä»¥çœ‹æˆIPv6åè®®æ‰€åœ¨çš„é“¾è·¯ç¯å¢ƒ

1. NATIVE
    è¿™ä¸ªéœ€è¦è¿è¥å•†ï¼ˆISPï¼‰æ”¯æŒï¼Œè¿™ç§æ–¹å¼å…è®¸è·¯ç”±å™¨ä¸‹çº§çš„å®¢æˆ·ç«¯ä¸æ‹¨å·æœåŠ¡å™¨ç›´æ¥é€šä¿¡å¹¶è·å–åŸç”ŸIPv6åœ°å€ï¼Œå¦‚æœåœ¨æ”¯æŒçš„ISPä¸‹ï¼Œé€‰æ‹©è·¯ç”±å™¨ä¸Šçš„NATIVEå°±å¯ä»¥äº†ï¼ŒNATIVEä¸‹å¯ä»¥é…ç½®æ— çŠ¶æ€é…ç½®IPv6æˆ–è€…é™æ€IPv6æˆ–è€…DHCPåˆ†é…IPv6ã€‚

2. PASSTHROUGH/RELAY(ä¸­ç»§æ¨¡å¼)
    åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œè·¯ç”±å™¨æˆä¸ºä¸‹ä¸€è·³ï¼Œä¸NATçš„åŒºåˆ«æ˜¯ï¼Œè·¯ç”±å™¨åªä¼šè½¬å‘æ•°æ®åŒ…ï¼Œå¹¶ä¸ä¼šä¿®æ”¹æºåœ°å€ã€‚
    åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯æ— çŠ¶æ€è‡ªåŠ¨ç”Ÿæˆçš„IPv6åœ°å€ï¼Œä¹Ÿå¯ä»¥åœç”¨æœ¬æœºæ¥å—RAå¹¿æ’­å¹¶ä½¿ç”¨è‡ªå·±é…ç½®çš„åœ°å€ï¼Œæ¯”å¦‚æ‹¨å·è·å–äº†`2001ï¼š250ï¼š7801ï¼š7788ï¼š`çš„å‰ç¼€ï¼Œä½ å¯ä»¥æŠŠè®¾å¤‡é…ç½®æˆ`2001ï¼š250ï¼š7801ï¼š7788ï¼šï¼š2`å¹¶ä¸”å¯ä»¥é€šä¿¡ã€‚ä½†æ˜¯ä¸€å®šè¦å…³é—­RAå¹¿æ’­é˜²æ­¢è®¾å¤‡é€šè¿‡DHCPæ¥è·å–åœ°å€ï¼Œä¸IPv4ä¸åŒï¼Œåœ¨IPv6åè®®ä¸­ï¼Œç½‘å¡å¯ä»¥åŒæ—¶æœ‰å¤šä¸ªIPv6åœ°å€ï¼Œå¹¶ä¸”DHCPè·å–åœ°å€çš„ä¼˜å…ˆçº§é«˜äºé™æ€åœ°å€ã€‚__è·¯ç”±å™¨é…ç½®ä¹Ÿç€é‡è®²è¿™ä¸ªæ–¹æ³•__
    ç†è®ºä¸Šè¯´ï¼Œå¦‚æœä½ æœ‰ä¸€å°æ”¯æŒIPv6çš„è¶³å¤Ÿå¼ºå¤§çš„è·¯ç”±å™¨ï¼ˆä½¿ç”¨relayæ–¹å¼ï¼‰ï¼Œä½ å¯ä»¥å°† **65536^4** ä¸ªè®¾å¤‡éƒ½è¿æ¥åˆ°è·¯ç”±å™¨ä¸Šå…±äº«ä½ çš„å¸¦å®½ï¼Œè€Œä¸”å¯ä»¥å®ç°å…¨çƒå¯è¾¾ã€‚

3. NAT
    è¿™ç§æ–¹å¼å°±æ˜¯åƒåœ¨IPv4æ¨¡å¼ä¸‹ä¸€æ ·ï¼Œè·¯ç”±å™¨æ›¿æ¢æºåœ°å€ï¼Œå¹¶ä¸”åˆ†é…ç»™ä½ çš„æ˜¯å†…ç½‘çš„IPv6åœ°å€ï¼Œä¹Ÿå°±æ˜¯å‰ç¼€ç¬¬ä¸€éƒ¨åˆ†åœ¨2000-3FFFä¹‹å¤–çš„åœ°å€ã€‚
    ä¸ªäººæ¯”è¾ƒæŠµåˆ¶è¿™ç§æ–¹å¼ï¼Œé™¤äº†å› ä¸ºå°è¯•äº†è¿™ä¸ªæ–¹æ¡ˆå¹¶å¤±è´¥äº†çš„åŸå› ä»¥å¤–ï¼Œ

    1. æ–°ç‰ˆæœ¬çš„å›ºä»¶å·²ç»ä¸å†æ”¯æŒæœ‰å…³çš„ä¾èµ–åŒ…;
    2. NATæœ¬èº«æ˜¯ä¸€ç§IPv4åœ°å€ä¸å¤Ÿç”¨è€ŒIPv6åè®®è¿˜æœªæ¨å¹¿æ—¶çš„ **å¦¥å** æ–¹æ¡ˆï¼Œæ˜¯IPv4çš„~~ç»­å‘½~~æ–¹å¼ï¼Œä¹Ÿæ˜¯é˜»ç¢æ¨å¹¿IPv6çš„ä¸€å¤§å› ç´ ;
    3. NATä¼šä½¿å¾—æœ¬èº«æ‰å¹³åŒ–çš„ç½‘ç»œç»“æ„è¢«å¼ºè¡Œåˆ†å±‚ï¼Œå¢åŠ è·¯ç”±è¡¨é•¿åº¦;
    4. NATè·å¾—çš„åœ°å€ **å…¨çƒä¸å¯è¾¾** ï¼Œè€Œé•¿è¿œæ¥çœ‹å…¨çƒå¯è¾¾åœ°å€å¯¹äºæ¸¸æˆã€PTä¸‹è½½ç­‰éœ€è¦å¤–ç½‘å¯è¾¾åœ°å€æ‰èƒ½å‘æŒ¥é«˜æ€§èƒ½çš„ç¨‹åºæœ‰å·¨å¤§æ„ä¹‰ã€‚

### æ·»åŠ è®¾ç½®
è€ƒè™‘åˆ°å­¦æ ¡ç½‘ç»œè²Œä¼¼ä¸èµ„ç“·NATIVEï¼Œä»¥åŠåœ°å€åˆ†é…é’ˆå¯¹è®¾å¤‡åˆ†é…ï¼Œå’Œé’ˆå¯¹NATçš„çœ‹æ³•å’Œå°è¯•å¤±è´¥åï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ä¸­ç»§æ–¹å¼ä½¿è·¯ç”±å™¨å¯ä»¥"åˆ†å‘"IPv6åœ°å€ã€‚

* è¿›å…¥è·¯ç”±å™¨åå°ï¼Œå¯ä»¥ä½¿ç”¨WinSCPè½¯ä»¶ç™»å½•åå°ï¼Œç›´æ¥åŒå‡»ç›®æ ‡æ–‡ä»¶æ‰“å¼€ç¼–è¾‘ï¼Œ`Ctrl+S`ä¿å­˜ã€‚
    å¦‚æœä¼šç”¨vimï¼Œç›´æ¥ç”¨vimç¼–è¾‘å³å¯ã€‚
* `/etc/config/dhcp`: é…ç½®å¥½relay
```
config dhcp 'lan'
    option interface 'lan'
    option start '100'
    option limit '150'
    option leasetime '12h'
    option ra 'relay'
    option dhcpv6 'relay'
    option ndp 'relay'

config dhcp 'wan'
    option interface 'wan'
    option ignore '1'

config dhcp 'wan6'
    option interface 'wan'
    option ra 'relay'
    option dhcpv6 'relay'
    option ndp 'relay'
    option master 1
```
* `/etc/config/network` åœ¨wanå£å¯ç”¨IPv6å¹¶è®¾ç½®wan6å£
```
config interface wan
    option IPv6 1

config interface 'wan6'
    option ifname 'eth0.2'
    option proto 'dhcpv6'
```
* `/etc/config/firewall` åœ¨é˜²ç«å¢™ä¸­ç¦ç”¨å¯¹IPv6çš„è¿‡æ»¤ï¼Œé˜²æ­¢LANå£IPv6é…ç½®ä¿¡æ¯è¢«è¿‡æ»¤
`option disable_IPv6 '1'`

* ä»¥ä¸Šè®¾ç½®å°±å¯ä»¥å®ç°å‘è®¾å¤‡åˆ†é…IPv6äº†ã€‚

* å¯¹äºopenwrt+è„šæœ¬å­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼Œå°±æ˜¯è·¯ç”±è¡¨ä¸æ­£ç¡®ï¼Œå°±æ˜¯è·¯ç”±è¡¨æŠŠæœ¬åº”è¯¥è·¯ç”±åˆ°lanå£åœ°å€è·¯ç”±åˆ°wanå£ï¼Œå½¢æˆloopç›´è‡³ttlè€—å°½ã€‚
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ä½¿ç”¨äº†å¤§ä½¬çš„è„šæœ¬ï¼š

1. æ–°å»º/usr/sbin/route6å¹¶è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š
```
while true
do
    pfix=`ip -6 route| grep default| grep ::/64|cut -d " " -f 3`
    result=`ip -6 route|grep pppoe-wan |grep $pfix | grep -v 'default'`
if [[ "$result" != "" ]]
then
    ip -6 route del $pfix
    ip -6 route add $pfix dev br-lan
fi
sleep 1
done
```
2. chmod +x /usr/sbin/route6

3. æ–°å»º/etc/init.d/route6å¹¶è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š
```
#!/bin/sh /etc/rc.common
# /init.d/route6

START=99

start() {
    route6 >/dev/null 2>&1 &
}

stop() {
    killall route6
}
```
4. 
```
chmod +x /usr/sbin/route6
chmod +x /etc/init.d/route6
```
5. `ln -s /etc/init.d/route6 S99route6`

* è¿™æ ·çš„è®¾ç½®èƒ½ä½¿å‡ºé”™çš„è·¯ç”±è¡¨åœ¨1så†…è¢«ä¿®æ­£ï¼Œå®æµ‹å ç”¨cpuä¸é«˜ï¼Œä¹Ÿä¸å½±å“é€šä¿¡ã€‚

* ä»¥ä¸Šæ˜¯IPv6çš„è®¾ç½®éƒ¨åˆ†ï¼Œè®¾ç½®å®Œæˆåï¼Œç”µè„‘çš„ç½‘ç»œè®¾ç½®ä¸­åº”è¯¥å¯ä»¥è·å¾—å¦‚ä¸‹ä¿¡æ¯ï¼š
![success](Linux-001-OpenWrt/success.png)

__é‚£ä¹ˆï¼ä¸ºäº†é¿å…åé¢çš„æ­¥éª¤å‡ºé—®é¢˜åˆè¦é‡æ¥çš„å°´å°¬ï¼Œç°åœ¨å»ç³»ç»Ÿçš„`å¤‡ä»½ä¸å‡çº§`ç•Œé¢ä¸­å°†ç°åœ¨çš„ç³»ç»Ÿå¤‡ä»½ä¸‹è½½ä¸‹æ¥__
__ä¸€å®šè¦åšè¿™ä¸€æ­¥ï¼ï¼ï¼__
å®Œæˆä»¥åé‡å¯è¯•è¯•~

## è¿‡æ¸¡æ®µè½
**è­¦ç¤ºï¼š** ä»åŸç†ä¸Šè¯´ï¼Œç›®å‰åœ¨ç¬”è®°æœ¬ç”µè„‘å’Œæ‰‹æœºå·²ç»å¯ä»¥åƒ[ä¸Šä¸€ç¯‡æ–‡ç« ](https://phantomt.github.io/2019/05/02/Linux-000-VPS/)ä¸­è®¾ç½®çš„é‚£æ ·ä½¿ç”¨ssè¿›è¡Œæ ¡å›­ç½‘ç©¿é€äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ä»¥ä¸‹æ­¥éª¤å¹¶ä¸å¿…è¦ã€‚
æˆ‘æ˜¯ä¸ºäº†è¯•éªŒæ‰è¿›è¡Œçš„ä¸‹é¢æ­¥éª¤ã€‚
**ä»¥ä¸‹æ­¥éª¤ä¸ä¸€å®šå¯ä»¥æˆåŠŸï¼Œä»…ä¾›å‚è€ƒï¼Œå¦‚å‘ç”Ÿæ„å¤–æƒ…å†µï¼Œè¯·è¿˜åŸåˆ°ä¸Šé¢å¤‡ä»½å¥½çš„ç³»ç»Ÿä½¿ç”¨ã€‚**

## å®‰è£…shadowsocks
*ä»¥ä¸‹æ­¥éª¤å‡éœ€è¦å®Œæˆ`opkg update`åè¿›è¡Œã€‚*

### æ–¹æ¡ˆä¸€/éƒ¨åˆ†ä¸€
#### ä¸€æ¬¡é…ç½®
* ä¸‹è½½[shadowsocks-libev-spec](https://sourceforge.net/projects/openwrt-dist/files/shadowsocks-libev/)å’Œ[luci-app-shadowsocks-spec](https://sourceforge.net/projects/openwrt-dist/files/luci-app/shadowsocks-spec/)
* è¿˜éœ€è¦å·²ç»é»˜è®¤å®‰è£…çš„`dnsmasq`ä¸ºå­ç½‘æä¾›DHCPå’ŒDNSï¼Œå’Œä¸€å¼€å§‹ä¸‹è½½çš„GNU wgetæ¥å®Œæˆhttpsä¸‹è½½ã€‚

* å°†ä¸‹è½½å®Œçš„æ–‡ä»¶ä½¿ç”¨WinSCPä¸Šä¼ åˆ°è·¯ç”±å™¨çš„`/tmp`ç›®å½•ä¸­ï¼Œå¹¶ä½¿ç”¨puttyè¿›å…¥`/tmp`ï¼š
`cd /tmp`
* ç„¶åå°±å¯ä»¥ä½¿ç”¨`opkg install xx.ipk`æ¥å®‰è£…äº†ã€‚
*Linuxå‘½ä»¤è¡Œä½¿ç”¨æŠ€å·§ï¼š1. å…ˆä½¿ç”¨`ls`å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶; 2. å¡«å†™æ–‡ä»¶åæ—¶ä½¿ç”¨`Tab`é”®å°è¯•è‡ªåŠ¨è¡¥å…¨*
* å®‰è£…å®Œæˆåä¾¿å¯ä»¥åœ¨Luciçš„ç•Œé¢çœ‹åˆ°`æœåŠ¡`ä¸‹çš„shadowsocksäº†ã€‚

* æš‚æ—¶å…ˆä¸å¼€å¯ShadowSocksï¼Œæ¥ç€é…ç½®dnsé¿å¼€DNSæ±¡æŸ“ã€‚
```
mkdir /etc/dnsmasq.d
//æ–°å»ºä¸€ä¸ªdnsmasq.dçš„ç›®å½•
//è¿™é‡Œè¾¹å­˜æ”¾dnsè§„åˆ™
 
echo "conf-dir=/etc/dnsmasq.d" >> /etc/dnsmasq.conf
//ä½¿dnsmasq.dç›®å½•å†…çš„è§„åˆ™ç”Ÿæ•ˆ
```
* ä¸‹è½½UDPæœ‰å…³çš„åŒ…
`opkg install iptables-mod-tproxy`
* ä¾æ¬¡ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥ä¸‹è½½å›½å†…åŸŸååŠ é€Ÿåˆ—è¡¨å’Œæ±¡æŸ“åœ°å€å±è”½åˆ—è¡¨ï¼Œè¿™ä¸¤ä¸ªåˆ—è¡¨ä¸€ä¸ªæ˜¯ç”¨æ¥è®¾å®šå›½å†…è®¿é—®ç™½åå•ï¼Œä¸€ä¸ªæ˜¯ç”¨æ¥å±è”½æ±¡æŸ“IPçš„é»‘åå•ï¼Œå…·ä½“å†…å®¹ä½ ä¹Ÿå¯ä»¥æ¥[è¿™é‡Œ](https://github.com/felixonmars/dnsmasq-china-list)ç§ç§ã€‚
```
wget -4 --no-check-certificate -O /etc/dnsmasq.d/accelerated-domains.china.conf https://raw.githubusercontent.com/felixonmars/dnsmasq-china-list/master/accelerated-domains.china.conf
 
wget -4 --no-check-certificate -O /etc/dnsmasq.d/bogus-nxdomain.china.conf https://raw.githubusercontent.com/felixonmars/dnsmasq-china-list/master/bogus-nxdomain.china.conf
 
echo "server=/#/127.0.0.1#7913" > gfwlist.conf
//æœ€åä¸€å¥æ˜¯è®©å…¶ä»–ä¸åœ¨åˆ—è¡¨ä¸­ï¼ˆå³å›½å¤–åŸŸåï¼‰éƒ½èµ°ä»£ç†è§£æï¼Œç«¯å£7913ã€‚
```

* ä¸‹é¢è¿›å…¥shadowsocksç•Œé¢æ·»åŠ è‡ªå·±çš„ä»£ç†ï¼Œæ³¨æ„ï¼šè¦æ·»åŠ æœåŠ¡å™¨çš„ **IPåœ°å€** ï¼Œå¡«å†™åŸŸåå¯èƒ½å¯¼è‡´æ— æ³•è§£æã€‚
* ç„¶åé…ç½®UDPè½¬å‘ï¼Œå¦‚æœåˆšæ‰æ²¡æœ‰å®‰è£…`iptables-mod-tproxy`ï¼Œåˆ™ä¼šæ˜¾ç¤ºå…¶ç¼ºå¤±ã€‚
å‹¾é€‰ï¼Œç„¶åæ ¹æ®å‰è¾¹`dnsmasq`çš„é…ç½®ï¼Œæˆ‘ä»¬è®¾ç½® **æœ¬åœ°ç«¯å£ä¸ºå¯¹åº”çš„7913** ä»¥æ¥æ”¶DNSæŸ¥è¯¢åŒ…ï¼Œç„¶åå¡«å†™è½¬å‘åœ°å€ï¼Œæˆ‘ä»¬è®©è¿™äº›æŸ¥è¯¢åŒ…é€šè¿‡SSä»£ç†ï¼Œç„¶åè®¿é—®åˆ°è°·æ­Œçš„å…¬å…±DNS __`8.8.4.4`çš„53ç«¯å£__ ä¸Š(`8.8.8.8`ä¹Ÿè¡Œ)ã€‚

* è¿™æ ·ä¸€æ¥ï¼Œå°±å®ç°äº†å›½å†…å›½å¤–æ™ºèƒ½é€‰ç”¨DNS(æŸ¥çœ‹`accelerated-domains.china.conf`ä»¥ç¡®è®¤å“ªäº›åŸŸåä¼šè¢«å‘é€åˆ°å›½å†…çš„`114.114.114.114`è§£æã€‚)
* å¼€å¯ShadowSocksï¼Œç„¶ååœ¨CLIç•Œé¢è¾“å…¥`/etc/init.d/dnsmasq restart`ä»¥é‡å¯dnsmasqæœåŠ¡ã€‚

#### è‡ªåŠ¨æ›´æ–°
* å»ºç«‹æ›´æ–°é‚£ä¸¤ä¸ªåˆ—è¡¨çš„è„šæœ¬
* åœ¨`/usr/bin`ç›®å½•ä¸‹åšå¦‚ä¸‹å‘½ä»¤ï¼š
```
touch updatednsmasq
//åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶
chmod +x updatednsmasq
//ç»™äºˆæ‰§è¡Œæƒé™
```
* ç¼–è¾‘updatednsmasqï¼š
(å¯ä»¥ä½¿ç”¨vimï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨WinSCPæ‰“å¼€ä¿®æ”¹)
```
cnlist() {
    wget -4 --no-check-certificate -O /etc/dnsmasq.d/accelerated-domains.china.conf https://raw.githubusercontent.com/felixonmars/dnsmasq-china-list/master/accelerated-domains.china.conf
    wget -4 --no-check-certificate -O /etc/dnsmasq.d/bogus-nxdomain.china.conf https://raw.githubusercontent.com/felixonmars/dnsmasq-china-list/master/bogus-nxdomain.china.conf
}
cnlist
```

* æ–°å»ºä¸€ä¸ªè®¡åˆ’ä»»åŠ¡ï¼Œè®©å®ƒæ¯å¤©ä¸­åˆ12ç‚¹è·‘ä¸€æ¬¡ã€‚
* åœ¨Luciç•Œé¢ä¸­ï¼Œæ‰“å¼€`ç³»ç»Ÿ-è®¡åˆ’ä»»åŠ¡`ï¼Œè¾“å…¥ï¼š
`* 12 * * * /usr/bin/updatednsmasq`
* è¿™æ ·æ¯å¤©ä¸­åˆ12ç‚¹ï¼Œåªè¦æœ‰ç½‘ï¼Œé‚£ä¹ˆDNSè¿™ä¸¤ä¸ªåˆ—è¡¨å°±éƒ½ä¼šæ›´æ–°ä¸€æ¬¡ã€‚

### æ–¹æ¡ˆäºŒ/éƒ¨åˆ†äºŒ
æ–¹æ¡ˆäºŒæ˜¯ç”¨å¦å¤–çš„æ–¹å¼æ¥åˆ¶å®šè½¬å‘è§„åˆ™çš„ï¼Œ**å¦‚æœä¸¤ç§æ–¹æ¡ˆä¸€èµ·ç”¨å¯èƒ½ä¼šå‡ºç°é—®é¢˜**ã€‚
#### ä¸€æ¬¡é…ç½®
* åŒæ ·å®‰è£…é‚£ä¸¤ä¸ªåŒ…ä»¥åŠåé¢çš„UDPç›¸å…³çš„åŒ…
* ä¸‹è½½å¿½ç•¥æ–‡ä»¶åˆ—è¡¨ï¼Œå¿½ç•¥å›½å†…ç½‘ç«™ï¼Œé¿å…è¿‡åº¦ä»£ç†
```
wget -O- 'http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest' | awk -F\| '/CN\|ipv4/ { printf("%s/%d\n", $4, 32-log($5)/log(2)) }' > /etc/ignore.list
```

* è¿›å…¥Luciç•Œé¢çš„shadowsocksç•Œé¢ï¼Œå°†åº•éƒ¨çš„è®¿é—®æ§åˆ¶ä¸­ï¼Œåœ¨`è¢«å¿½ç•¥IPåˆ—è¡¨`å¡«å†™ç¬¬1æ­¥ä¸‹è½½çš„`/etc/ignore.list`ã€‚
* åˆ°`ç½‘ç»œ-DHCP/DNS-åŸºæœ¬è®¾ç½®`ï¼ŒæŠŠDNSè½¬å‘åœ°å€å¡«ä¸Š`127.0.0.1#7913`
* åˆ°`ç½‘ç»œ-DHCP/DNS-hostå’Œè§£ææ–‡ä»¶é‡Œ`æŠŠ`å¿½ç•¥è§£ææ–‡ä»¶`å‹¾ä¸Šã€‚

**è‹¯å®å®åªè¿›è¡Œåˆ°è¿™é‡Œï¼Œå› ä¸ºåé¢çš„åŠ å…¥äº†å‡ºç°äº†é—®é¢˜å¦‚æ— æ³•è”ç½‘ï¼Œç”šè‡³è¿`202.204.67.15`éƒ½æ‰“ä¸å¼€çš„é—®é¢˜ï¼Œå› æ­¤ä¸‹é¢çš„è„šæœ¬è¯·è°¨æ…ä½¿ç”¨**

#### è‡ªåŠ¨æ›´æ–°list
* åœ¨`/etc/`ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª`ignore.list.update.sh`è„šæœ¬æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
```
wget -O- 'http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest' | awk -F\| '/CN\|ipv4/ { printf("%s/%d\n", $4, 32-log($5)/log(2)) }' > /etc/ignore.list
/etc/init.d/shadowsocks restart
```
* ç»™äºˆæ‰§è¡Œæƒé™:
`chmod +x /etc/ignore.list.update.sh`
* å¯ä»¥ç”¨`sh ignore.list.update.sh`å‘½ä»¤æ‰§è¡Œçœ‹çœ‹æœ‰æ²¡æœ‰æ­£ç¡®æ‰§è¡Œã€‚

* åŒæ ·ä½¿ç”¨è®¡åˆ’ä»»åŠ¡æ˜¯å…¶æ¯å¤©12ç‚¹æ‰§è¡Œä¸€æ¬¡æ›´æ–°ï¼š
`* 12 * * *sh /etc/ignore.list.update.sh`


## ç»“æŸ
é‚£ä¹ˆåˆ°è¿™é‡Œé…ç½®å°±å…¨éƒ¨å®Œæˆäº†ï¼Œå¯ä»¥è¿›è¡ŒIPv6ç½‘ç»œæµ‹è¯•ï¼Œ
### æµ‹è¯•
ä¸‹é¢æœ‰å‡ ä¸ªæµ‹è¯•ç½‘ç«™ï¼š
[kame](http://www.kame.net/)ï¼Œè¿™ä¸ªç½‘ç«™ä¸­å¦‚æœèƒ½å¤Ÿä½¿ç”¨IPv6åˆ™èƒ½çœ‹åˆ°ä¸€åªåŠ¨æ€çš„å°ä¹Œé¾Ÿï¼Œå¦‚æœä¸èƒ½ä½¿ç”¨åˆ™æ˜¯é™æ­¢çš„ã€‚
![keme](Linux-001-OpenWrt/testv6.png)
[ipv6-test](http://ipv6-test.com/)ï¼Œæµ‹è¯•å¸¦å®½ä»¥åŠè¿æ¥çŠ¶å†µ
![ipv6test](Linux-001-OpenWrt/speedtest.png)
![ipv6ping](Linux-001-OpenWrt/pingtest.png)
ä¸‹é¢æ˜¯æ‰‹æœºåœ¨ **èƒ½å¤Ÿè¿æ¥IPv6ä»£ç†æ—¶** è¿›è¡Œæµ‹é€Ÿçš„ç»“æœ
![phonetest](Linux-001-OpenWrt/phonev6.jpg)

å¯ä»¥çœ‹åˆ°ï¼Œç›¸æ¯”äºæ—¥å¸¸ç½‘é€Ÿ300kB/sçš„IPv4ç½‘ç»œæ¥è¯´ï¼ŒIPv6ç½‘ç»œæ¢ç®—çš„é€Ÿåº¦4MB/så¿«äº†å¾ˆå¤šï¼Œè€Œå®é™…ä½¿ç”¨ä¸Šæœ€å¿«å¯ä»¥è¾¾åˆ°20MB/sçš„é€Ÿåº¦ã€‚
æ‰‹æœºè¿æ¥ssåå¯ä»¥è®¿é—®è°·æ­Œå…¨å®¶æ¡¶ä»¥åŠInstagramç­‰APPã€‚

### ç¼ºç‚¹
å‘çˆ¹çš„å“”å“©å“”å“©å®¢æˆ·ç«¯å±…ç„¶ä¸æ”¯æŒåœ¨ä¸è¿æ ¡å›­ç½‘ä»…è¿ä»£ç†å…æµçš„æƒ…å†µä¸‹æ‰“å¼€ï¼Œè€Œå…¶ä»–çš„è½¯ä»¶éƒ½å¯ä»¥æˆåŠŸæ‰“å¼€ä½¿ç”¨ï¼Œåªæœ‰ **å“”å“©å“”å“©å®¢æˆ·ç«¯ä¸è¡Œ** ï¼Œè¿™ä¸€ç‚¹å¯ä»¥è¯´æ˜¯éå¸¸ä¸å®Œç¾äº†ã€‚
iOSç³»ç»Ÿçš„ä»£ç†è½¯ä»¶å›½åŒºè¢«ä¸‹æ¶ï¼Œå‰©ä½™çš„è½¯ä»¶éœ€è¦èŠ±é’±è´­ä¹°ï¼Œå› æ­¤ä¸æ‰æ²¡æœ‰è¿›è¡Œæµ‹è¯•ã€‚(Androidå¤§æ³•å¥½~)
å¦‚æœæ²¡æœ‰ssä»£ç†ï¼Œç›®å‰æ˜¯ä¸èƒ½å®ç°å®Œç¾æ ¡å›­ç½‘å…æµçš„ï¼Œä½†æ˜¯é€Ÿåº¦ä¼šæœ‰æå‡ã€‚
ä½¿ç”¨ssä»£ç†å¯ä»¥ __æé€Ÿå¹¶*åŸºæœ¬*å®ç°å…æµ__ ã€‚

**å¦‚æœæœ‰å¤§ä½¬èƒ½å¤Ÿè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ–è€…æœ‰æ›´å¥½çš„é…ç½®æ–¹æ³•ï¼Œè¯·ä¸€å®šå‘Šè¯‰æˆ‘ã€‚**

## æ„Ÿå—ä¸åæ§½
ä¸ºäº†å®Œæˆè¿™ä¸ªç›®æ ‡ï¼Œè‹¯å®å®çœŸæ˜¯çœ‹äº†ç½‘ä¸Šèƒ½æ‰¾åˆ°çš„æ‰€æœ‰Openwrtä»¥åŠç›¸å…³å¼€æºç³»ç»Ÿçš„IPv6è®¾ç½®ï¼Œå…¶ä¸­ä¹Ÿæœ‰ä¸€äº›å…¶ä»–å­¦æ ¡åŒå­¦çš„è®°å½•ï¼Œ
æ¯”å¦‚ï¼šåå—ç†å·¥ï¼Œæ¸…åï¼ŒåŒ—é‚®ï¼ŒåŒ—èˆªï¼Œå“ˆå·¥å¤§ç­‰ï¼Œ(æ¸…åå¤§ä½¬çš„åšå®¢å±…ç„¶è¦ç”¨ä»£ç†æ‰èƒ½è¿ä¸Š= =)ï¼Œå…¶ä¸­NATæ–¹æ¡ˆçš„ç»„ä»¶ä¸€ç§æ¥è‡ªåŒ—é‚®ï¼Œè¦é€šè¿‡å¼€å§‹çš„ç¼–è¯‘åŠ å…¥;å¦ä¸€ç§æ¥è‡ªè¥¿ç”µç ”ç©¶ç”Ÿçš„ä½œå“ï¼Œä»¥å®‰è£…å½¢å¼åŠ å…¥ã€‚æ— è®ºå¦‚ä½•è®¾ç½®ï¼Œç†è®ºè”ç³»å®é™…æ€»æ˜¯å……æ»¡è‰°è¾›ã€‚
æˆ‘ä¹Ÿçœ‹äº†ä¸‹Openwrtçš„å®˜æ–¹æŒ‡å¯¼(ä¹Ÿæ²¡æ€ä¹ˆçœ‹æ‡‚)ï¼Œå¤§æ¦‚ç¡®è®¤äº†ç°åœ¨çš„æ–¹å‘ï¼Œå¯èƒ½å’Œå¤§ä½¬ä»¬çš„ç»“æœæœ‰äº›å·®è·ï¼Œä¸è¿‡æˆ‘è§‰å¾—è¿˜æ˜¯å¾ˆç¬¦åˆæˆ‘è‡ªå·±çš„éœ€æ±‚çš„ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œå†å¯¹è·¯ç”±å™¨çš„ssè¿›è¡Œä¼˜åŒ–ä¿®æ”¹ã€‚
DHCPv6å’Œä¸­ç»§æ¨¡å¼çš„IPv6åœ°å€åº”è¯¥æ˜¯ä¸ä¸€æ ·çš„ã€‚

**IPv6ä¹Ÿæ˜¯æœªæ¥çš„è¶‹åŠ¿**ï¼Œéšç€è®¾å¤‡å’Œç³»ç»Ÿçš„æ›´è¿­å‡çº§ï¼Œä»¥åçš„é…ç½®è‚¯å®šä¹Ÿä¼šè¶Šæ¥è¶Šç®€å•ï¼ŒåŒæ ·éšç€æˆ‘å›½ç½‘æ°‘çš„è®¤çŸ¥æ°´å“ä»¥åŠåˆ¤æ–­åŠ›çš„ä¸æ–­æé«˜ï¼ŒG*Wè‚¯å®šä¹Ÿä¼šé€æ¸å˜å¾—å®½æ¾ï¼Œä¸ŠğŸ”¼ç½‘ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šæ–¹ä¾¿ã€‚

> è¿™æŠŠä¸ä»…å¥½å¥½è®¤è¯†äº†ä¸€æŠŠIPv6ï¼Œè¿˜è§è¯†äº†Linuxç³»ç»Ÿçš„ç¼–è¯‘ï¼Œæœ‰äº›ä¸œè¥¿å¹¶æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆéš¾ï¼Œè€Œæœ‰äº›äº‹åšèµ·æ¥ç¡®å®å¾ˆéš¾ã€‚
> çœ‹åˆ°äº†sså’Œssrçš„å‘½è¿çº è‘›å’Œæˆ‘ä»¬åƒç“œç¾¤ä¼—çš„ç…½é£ç‚¹ç«ï¼Œä¹Ÿè®¸ï¼Œç¯å¢ƒä¸æˆ‘ä»¬ä¹‹é—´çš„ç›¸äº’ä½œç”¨æ¯”æƒ³è±¡ä¸­æ›´å¼ºã€‚
> å’Œå¾ˆå¤šå¤§ä½¬çš„NATæ–¹æ¡ˆä¸ä¸€æ ·ï¼Œä¹Ÿè®¸ç»“æœä¹Ÿä¸ä¸€æ ·ã€‚
> ç†è®ºè”ç³»å®é™…å¾ˆè‰°éš¾ï¼Œå°¤å…¶å½“ç†è®ºä¸æ‰å®ï¼Œå®é™…é—®é¢˜æœ‰å¾ˆå¤šçš„æ—¶å€™ã€‚
> çœŸçš„ï¼Œæœ‰çš„å¤§ä½¬æ˜¯çœŸçš„ä¼šç©0.0
> è®¡ç®—æœºç½‘ç»œçœŸçš„ä¸ä»…å¤šè¿˜å¾ˆæ‚0.0

## å‚è€ƒé“¾æ¥
[å“ˆå·¥å¤§å¤§ä½¬çš„å¸–å­](http://tieba.baidu.com/p/5640074547)
[è·¯ç”±å™¨åˆ·OpenWRTå®‰è£…shadowsocksä½¿ç”¨é€æ˜ä»£ç†+å»DNSæ±¡æŸ“](https://www.logcg.com/archives/860.html)
[è‡ªåŠ¨æ›´æ–°DNSè½¬å‘åˆ—è¡¨](https://www.logcg.com/archives/868.html)
[ç½‘ä»¶3800è·¯ç”±å™¨å®‰è£…shadowsocksæŠ˜è…¾è®°(äºŒ)](https://www.8dlive.com/post/314.html)
[æ¸…åæœ¬ç§‘ç”Ÿé€‚ç”¨è·¯ç”±å™¨é…ç½®æŒ‡å—](https://dangfan.me/zh-Hans/posts/router)
[OpenWRTé…ç½®IPv6çš„NATï¼ˆä¸€èˆ¬ç»“åˆisatapä½¿ç”¨ï¼‰](https://blog.blahgeek.com/2014/02/22/openwrt-ipv6-nat/)
[åœ¨OpenWrtä¸Šé…ç½®åŸç”ŸIPv6 NAT](https://tang.su/2017/03/openwrt-ipv6-nat/)
[IPv6çš„NATåŸç†ä»¥åŠMAP66](https://blog.csdn.net/dog250/article/details/7799398)`IPv6çš„æ ‡å‡†ä¸­ä¸å»ºè®®ä½¿ç”¨NAT`